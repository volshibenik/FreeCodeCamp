<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>ttt</title>
</head>
<body>

	<script>
		var human = 'x';
		var AI = 'o';
		var currentBoard = ['x', 1, 'x',
										 'o', 4, 'o',
										 6, 'o', 'x'];
		
		
		function emptyInd (board) {
			return board.filter(function(e){
				if (e!='o' && e!='x')
				return e;
			}) 
		}

		function winning(board, player){
			if (
				(board[0] == player && board[1] == player && board[2] == player) ||
				(board[3] == player && board[4] == player && board[5] == player) ||
				(board[6] == player && board[7] == player && board[8] == player) ||
				(board[0] == player && board[3] == player && board[6] == player) ||
				(board[1] == player && board[4] == player && board[7] == player) ||
				(board[2] == player && board[5] == player && board[8] == player) ||
				(board[0] == player && board[4] == player && board[8] == player) ||
				(board[2] == player && board[4] == player && board[6] == player)
			) {
				return true;
			} else {
				return false;
			}
		}
		
		function minimax(newBoard, player) {
			
			var availSpots = emptyInd(newBoard);
			
			if (winning(newBoard, human)) {
				
				return {score:-10}
				
			}else if (winning(newBoard, AI)) {
				
				return {score:10}
				
			}else if (availSpots.length===0) {
				
				return {score:0}
				
			}
			
			var moves = [];
			
			
			for (var i = 0; i < availSpots.length; i++) {
				//create an object for each and store the index of that spot 
				var move = {};
				move.index = newBoard[availSpots[i]];
				// set the empty spot to the current player
				newBoard[availSpots[i]] = player;
				
				/*collect the score resulted from calling minimax 
      on the opponent of the current player*/
				if (player == AI) {
					
					var result = minimax(newBoard, human);
					move.score = result.score;
					
				}else {
					
					var result = minimax(newBoard, AI);
					move.score = result.score;
					
				}
				//reset the spot to empty
				newBoard[availSpots[i]] = move.index;
				console.log('move',move);
				moves.push(move);
			}

			
			// if it is the computer's turn loop over the moves and choose the move with the highest score
			var bestMove;
			if(player === AI){
				var bestScore = -10000;
				for(var i = 0; i < moves.length; i++){
					if(moves[i].score > bestScore){
						bestScore = moves[i].score;
						bestMove = i;
					}
				}
			}else{
				
				// else loop over the moves and choose the move with the lowest score
				var bestScore = 10000;
				for(var i = 0; i < moves.length; i++){
					if(moves[i].score < bestScore){
						bestScore = moves[i].score;
						bestMove = i;
					}
				}
			}
			
			// return the chosen move (object) from the moves array
	//		console.log(moves[bestMove]);
			return moves[bestMove];
			
}
			
			
			
		var k = minimax(currentBoard, AI);
		console.log('k', k);
		
		
	</script>
	
</body>
</html>